# OpenAPI Inspection Report

Created: 2026-02-23
Updated: 2026-02-23

Findings from inspecting `/docs`, `/redoc`, and `/openapi.json` (backend on port 8000 local / 9180 Docker).

## Documentation Endpoints: Functional

- **Swagger UI** (`/docs`): Interactive; lists all paths, try-it-out works.
- **ReDoc** (`/redoc`): Readable; groups by tag where present.
- **OpenAPI JSON** (`/openapi.json`): Valid 3.1.0; auto-generated by FastAPI.

## Duplication and Redundancy

### 1. Documents: v0 vs v1 Overlap

| v0 | v1 | Issue |
|----|-----|------|
| `POST /api/documents/upload` | `POST /api/v1/upload` | Two upload endpoints; different contracts (sync vs async/task-based) |
| `GET /api/documents/list` | `GET /api/v1/list` | Two list endpoints; similar semantics |
| `DELETE /api/documents/{filename}` | `DELETE /api/v1/task/{task_id}` | Delete by filename vs task_id |

**Recommendation**: Consolidate in v1 per [API_REDESIGN.md](API_REDESIGN.md). Deprecate v0 after migration.

### 2. Health Endpoints

- `/health` — backward compatibility
- `/api/health` — API health
- `/api/health/database`, `/api/health/llm`, `/api/health/vector`, `/api/health/auth`, `/api/health/websocket` — per-service
- `/api/ask/health` — ask-specific
- `/api/stt/health` — STT-specific

**Assessment**: Multiple health routes serve different granularity (liveness vs dependency checks). Not redundant; document hierarchy in API_ENDPOINTS.md.

### 3. Upload Response Schema Gaps

`POST /api/documents/upload` response in OpenAPI:
- Documents only `200`; missing `201` for new uploads.
- Response schema is `additionalProperties: true` — does not document `created`, `status`, `file_id`.

**Recommendation**: Add explicit Pydantic response model (e.g. `UploadResponse`) with `created: bool`, `status: str`, `file_id: str` and document both 200 and 201 in the route.

### 4. Tags

- Most routes have tags (`documents`, `documents-enhanced`, `query`, `question-answering`, `chat`, `metrics`, etc.).
- Health routes lack tags — consider adding `health` tag for grouping in ReDoc.

## References

- [API_DESIGN.md](API_DESIGN.md)
- [API_ENDPOINTS.md](API_ENDPOINTS.md)
- [API_REDESIGN.md](API_REDESIGN.md)
